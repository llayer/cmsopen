{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "uniform-ready",
   "metadata": {},
   "source": [
    "## BDT training"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "damaged-three",
   "metadata": {},
   "outputs": [],
   "source": [
    "import glob\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import importlib"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "designing-township",
   "metadata": {},
   "outputs": [],
   "source": [
    "BASE_DIR = \"/eos/user/l/llayer/cmsopen/columnar/syst_variation/\"\n",
    "SAMPLES_DIR = BASE_DIR + \"samples\"\n",
    "CAND_DIR = BASE_DIR + \"cand\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "scheduled-killing",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    }
   ],
   "source": [
    "files = glob.glob( CAND_DIR + \"/*.h5\")\n",
    "print()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "immune-causing",
   "metadata": {},
   "outputs": [],
   "source": [
    "#files = glob.glob( CAND_DIR + \"/*.h5\")\n",
    "samples = {}\n",
    "for sample in [\"Data\", \"QCD\", \"TTJets_centJER_signal\", \"TTJets_centJER_bkg\", \"STJets_centJER\", \"WZJets_centJER\"]:\n",
    "    #sample_name = sample.split(\"/\")[-1][:-3]\n",
    "    #print(sample_name)\n",
    "    samples[sample] = pd.read_hdf(CAND_DIR + \"/\" + sample + \".h5\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "wrapped-wages",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Welcome to JupyROOT 6.20/06\n"
     ]
    }
   ],
   "source": [
    "import ml"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 148,
   "id": "hydraulic-blade",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Set random state\n",
      "Prepare training data\n",
      "['Jet_pt', 'Jet_px', 'Jet_py', 'Jet_pz', 'Jet_e', 'Jet_eta', 'Jet_phi', 'Jet_mass', 'Jet_csvDisc', 'Jet_flavour', 'Tau_pt', 'Tau_px', 'Tau_py', 'Tau_pz', 'Tau_e', 'Tau_eta', 'Tau_phi', 'Tau_mass', 'Tau_charge', 'MET_pt', 'MET_px', 'MET_py', 'MET_pz', 'MET_e', 'MET_met', 'event', 'run', 'luminosityBlock', 'HLT_QuadJet40_IsoPFTau40', 'HLT_QuadJet45_IsoPFTau45', 'genEvent_tmeme', 'nJets', 'Jet_nbtags', 'ht', 'aplanarity', 'sphericity', 'chargeEta', 'met', 'deltaPhiTauMet', 'mt', 'mTauJet', 'Jet_btagSF', 'Jet_btagSF_up', 'Jet_btagSF_down', 'Jet_beff', 'Jet_btag_weight1', 'Jet_btag_weight1_up', 'Jet_btag_weight1_down', 'trigger_weight', 'trigger_weight_up', 'trigger_weight_down', 'norm', 'norm_up', 'norm_down', 'pdf', 'pdf_up', 'pdf_down', 'train_flag', 'label', 'bdt', 'weight']\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/eos/home-l/llayer/cmsopen/columnar/ml.py:91: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  signal_train[\"weights\"] = signal_train['trigger_weight'] * signal_train['Jet_btag_weight1']\n",
      "/eos/home-l/llayer/cmsopen/columnar/ml.py:92: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  signal_train[\"weights\"] = signal_train[\"weights\"] * (1. / np.mean(signal_train[\"weights\"]))\n",
      "/eos/home-l/llayer/cmsopen/columnar/ml.py:95: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  bkg_train[\"weights\"] = bkg_train['btag_weight']\n",
      "/eos/home-l/llayer/cmsopen/columnar/ml.py:96: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  bkg_train[\"weights\"] = bkg_train[\"weights\"] * (1. / np.mean(bkg_train[\"weights\"]))\n",
      "/eos/home-l/llayer/cmsopen/columnar/ml.py:99: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version\n",
      "of pandas will change to not sort by default.\n",
      "\n",
      "To accept the future behavior, pass 'sort=False'.\n",
      "\n",
      "To retain the current behavior and silence the warning, pass 'sort=True'.\n",
      "\n",
      "  train_data = pd.concat([signal_train, bkg_train], axis=0)\n",
      "/eos/home-l/llayer/cmsopen/columnar/ml.py:100: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version\n",
      "of pandas will change to not sort by default.\n",
      "\n",
      "To accept the future behavior, pass 'sort=False'.\n",
      "\n",
      "To retain the current behavior and silence the warning, pass 'sort=True'.\n",
      "\n",
      "  test_data = pd.concat([signal_test, bkg_test], axis=0)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train model\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/cvmfs/sft.cern.ch/lcg/views/LCG_97apython3/x86_64-centos7-gcc8-opt/lib/python3.7/site-packages/xgboost/core.py:587: FutureWarning: Series.base is deprecated and will be removed in a future version\n",
      "  if getattr(data, 'base', None) is not None and \\\n",
      "/cvmfs/sft.cern.ch/lcg/views/LCG_97apython3/x86_64-centos7-gcc8-opt/lib/python3.7/site-packages/xgboost/core.py:588: FutureWarning: Series.base is deprecated and will be removed in a future version\n",
      "  data.base is not None and isinstance(data, np.ndarray) \\\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Predicting...\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "importlib.reload(ml)\n",
    "ml.train(samples, \".\", n_sig=10000, n_bkg=5000, ntrees=500, lr=0.01, random_state=10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 149,
   "id": "ranging-silence",
   "metadata": {},
   "outputs": [],
   "source": [
    "import plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 150,
   "id": "built-idaho",
   "metadata": {},
   "outputs": [],
   "source": [
    "variables = [\n",
    "    {\"var_name\" : \"bdt\", \"bins\" : 20, \"xlow\" : 0., \"xup\" : 1., \"xtitle\" : \"bdt\"}\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 151,
   "id": "julian-abuse",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Data bdt None\n",
      "QCD bdt None\n",
      "Change name\n",
      "TTJets_signal_centJER\n",
      "TTJets_signal_centJER bdt None\n",
      "1.2960368771746387 347.1658808435174 347.1658808435174\n",
      "Change name\n",
      "TTJets_bkg_centJER\n",
      "TTJets_bkg_centJER bdt None\n",
      "STJets_centJER bdt None\n",
      "WZJets_centJER bdt None\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/eos/home-l/llayer/cmsopen/columnar/plot.py:30: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  sample['weight'] = sample['btag_weight'] * scale_qcd\n"
     ]
    }
   ],
   "source": [
    "importlib.reload(plot)\n",
    "plot.vars_to_histos(samples, variables, \"histos.root\", syst=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 152,
   "id": "traditional-barrel",
   "metadata": {},
   "outputs": [],
   "source": [
    "import ROOT"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 153,
   "id": "unusual-making",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "TFile**\t\thistos.root\t\n",
      " TFile*\t\thistos.root\t\n",
      "  KEY: TH1D\tData_bdt;1\tData_bdt\n",
      "  KEY: TH1D\tQCD_bdt;1\tQCD_bdt\n",
      "  KEY: TH1D\tTTJets_signal_centJER_bdt;1\tTTJets_signal_centJER_bdt\n",
      "  KEY: TH1D\tTTJets_bkg_centJER_bdt;1\tTTJets_bkg_centJER_bdt\n",
      "  KEY: TH1D\tSTJets_centJER_bdt;1\tSTJets_centJER_bdt\n",
      "  KEY: TH1D\tWZJets_centJER_bdt;1\tWZJets_centJER_bdt\n"
     ]
    }
   ],
   "source": [
    "f = ROOT.TFile(\"histos.root\")\n",
    "f.ls()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 154,
   "id": "suited-investor",
   "metadata": {},
   "outputs": [],
   "source": [
    "import fit"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 156,
   "id": "inappropriate-burden",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_centJER_bdt\n",
      "TTJets_bkg 143.36512967476312\n",
      "WZJets_centJER_bdt\n",
      "WZJets 63.73465056276217\n",
      "STJets_centJER_bdt\n",
      "STJets 30.224785537131964\n",
      "QCD_bdt\n",
      "QCD 2627.1896301563747\n",
      "TTJets_signal_centJER_bdt\n",
      "TTJets_signal 347.1658808435174\n",
      "scale factor TTbar tau(h) QQ  0.9220688623634176 +- 0.07799018785838681\n",
      "scale factor MultiJet  1.0602830315140843 +- 0.010305891875569207\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **  190 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  191 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **  192 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  193 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  194 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **  195 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=243.195 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.29910e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-329.186 FROM MIGRAD    STATUS=CONVERGED      17 CALLS          18 TOTAL\n",
      "                     EDM=6.92095e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           1.03073e-01   8.71808e-03   3.54753e-04   2.90104e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.603e-05 \n",
      " **********\n",
      " **  196 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  197 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  198 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-329.186 FROM HESSE     STATUS=OK              5 CALLS          23 TOTAL\n",
      "                     EDM=6.92091e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           1.03073e-01   8.71808e-03   7.09505e-05  -9.17121e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.603e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n"
     ]
    }
   ],
   "source": [
    "sample_names = [\"Data\", \"TTJets_bkg\", \"WZJets\", \"STJets\", \"QCD\", \"TTJets_signal\"]\n",
    "sf_tt_sig, sf_qcd = fit.fit(\"histos.root\", sample_names, \"bdt\", corr=\"centJER\")\n",
    "sfs = {}\n",
    "sfs[\"TTJets_signal\"] = sf_tt_sig\n",
    "sfs[\"QCD\"] = sf_qcd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "welsh-method",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "needed-soldier",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "pharmaceutical-functionality",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
