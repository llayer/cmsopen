{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "functional-karma",
   "metadata": {},
   "source": [
    "## BDT training"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "undefined-shakespeare",
   "metadata": {},
   "outputs": [],
   "source": [
    "import glob\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import importlib"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "surprising-lafayette",
   "metadata": {},
   "outputs": [],
   "source": [
    "BASE_DIR = \"/eos/user/l/llayer/cmsopen/columnar/syst_variation/\"\n",
    "SAMPLES_DIR = BASE_DIR + \"samples\"\n",
    "CAND_DIR = BASE_DIR + \"cand\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "color-acting",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    }
   ],
   "source": [
    "files = glob.glob( CAND_DIR + \"/*.h5\")\n",
    "print()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "upper-filing",
   "metadata": {},
   "outputs": [],
   "source": [
    "#files = glob.glob( CAND_DIR + \"/*.h5\")\n",
    "samples = {}\n",
    "for sample in [\"Data\", \"QCD\", \"TTJets_centJER_signal\", \"TTJets_centJER_bkg\", \"STJets_centJER\", \"WZJets_centJER\"]:\n",
    "    #sample_name = sample.split(\"/\")[-1][:-3]\n",
    "    #print(sample_name)\n",
    "    samples[sample] = pd.read_hdf(CAND_DIR + \"/\" + sample + \".h5\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "random-adobe",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Welcome to JupyROOT 6.20/06\n"
     ]
    }
   ],
   "source": [
    "import ml"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "chinese-cheese",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Set random state\n",
      "Prepare training data\n",
      "['Jet_pt', 'Jet_px', 'Jet_py', 'Jet_pz', 'Jet_e', 'Jet_eta', 'Jet_phi', 'Jet_mass', 'Jet_csvDisc', 'Jet_flavour', 'Tau_pt', 'Tau_px', 'Tau_py', 'Tau_pz', 'Tau_e', 'Tau_eta', 'Tau_phi', 'Tau_mass', 'Tau_charge', 'MET_pt', 'MET_px', 'MET_py', 'MET_pz', 'MET_e', 'MET_met', 'event', 'run', 'luminosityBlock', 'HLT_QuadJet40_IsoPFTau40', 'HLT_QuadJet45_IsoPFTau45', 'genEvent_tmeme', 'nJets', 'Jet_nbtags', 'ht', 'aplanarity', 'sphericity', 'chargeEta', 'met', 'deltaPhiTauMet', 'mt', 'mTauJet', 'Jet_btagSF', 'Jet_btagSF_up', 'Jet_btagSF_down', 'Jet_beff', 'Jet_btag_weight1', 'Jet_btag_weight1_up', 'Jet_btag_weight1_down', 'trigger_weight', 'trigger_weight_up', 'trigger_weight_down', 'norm', 'norm_up', 'norm_down', 'pdf', 'pdf_up', 'pdf_down', 'train_flag', 'label', 'bdt', 'weight']\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/eos/home-l/llayer/cmsopen/columnar/ml.py:91: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  signal_train[\"weights\"] = signal_train['trigger_weight'] * signal_train['Jet_btag_weight1']\n",
      "/eos/home-l/llayer/cmsopen/columnar/ml.py:92: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  signal_train[\"weights\"] = signal_train[\"weights\"] * (1. / np.mean(signal_train[\"weights\"]))\n",
      "/eos/home-l/llayer/cmsopen/columnar/ml.py:95: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  bkg_train[\"weights\"] = bkg_train['btag_weight']\n",
      "/eos/home-l/llayer/cmsopen/columnar/ml.py:96: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  bkg_train[\"weights\"] = bkg_train[\"weights\"] * (1. / np.mean(bkg_train[\"weights\"]))\n",
      "/eos/home-l/llayer/cmsopen/columnar/ml.py:99: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version\n",
      "of pandas will change to not sort by default.\n",
      "\n",
      "To accept the future behavior, pass 'sort=False'.\n",
      "\n",
      "To retain the current behavior and silence the warning, pass 'sort=True'.\n",
      "\n",
      "  train_data = pd.concat([signal_train, bkg_train], axis=0)\n",
      "/eos/home-l/llayer/cmsopen/columnar/ml.py:100: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version\n",
      "of pandas will change to not sort by default.\n",
      "\n",
      "To accept the future behavior, pass 'sort=False'.\n",
      "\n",
      "To retain the current behavior and silence the warning, pass 'sort=True'.\n",
      "\n",
      "  test_data = pd.concat([signal_test, bkg_test], axis=0)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train model\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/cvmfs/sft.cern.ch/lcg/views/LCG_97apython3/x86_64-centos7-gcc8-opt/lib/python3.7/site-packages/xgboost/core.py:587: FutureWarning: Series.base is deprecated and will be removed in a future version\n",
      "  if getattr(data, 'base', None) is not None and \\\n",
      "/cvmfs/sft.cern.ch/lcg/views/LCG_97apython3/x86_64-centos7-gcc8-opt/lib/python3.7/site-packages/xgboost/core.py:588: FutureWarning: Series.base is deprecated and will be removed in a future version\n",
      "  data.base is not None and isinstance(data, np.ndarray) \\\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Predicting...\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "importlib.reload(ml)\n",
    "ml.train(samples, \".\", n_sig=4000, n_bkg=4000, ntrees=1000, lr=0.01, random_state=2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "cellular-explorer",
   "metadata": {},
   "outputs": [],
   "source": [
    "import plot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "encouraging-yorkshire",
   "metadata": {},
   "outputs": [],
   "source": [
    "variables = [\n",
    "    {\"var_name\" : \"bdt\", \"bins\" : 15, \"xlow\" : 0., \"xup\" : 1., \"xtitle\" : \"bdt\"}\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "ready-cabin",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Data bdt None\n",
      "QCD bdt None\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/eos/home-l/llayer/cmsopen/columnar/plot.py:30: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  sample['weight'] = sample['btag_weight'] * scale_qcd\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Change name\n",
      "TTJets_signal_centJER\n",
      "TTJets_signal_centJER bdt None\n",
      "1.1010517344156752 347.1658808435184 347.1658808435184\n",
      "Change name\n",
      "TTJets_bkg_centJER\n",
      "TTJets_bkg_centJER bdt None\n",
      "STJets_centJER bdt None\n",
      "WZJets_centJER bdt None\n"
     ]
    }
   ],
   "source": [
    "importlib.reload(plot)\n",
    "plot.vars_to_histos(samples, variables, \"histos.root\", syst=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "reserved-installation",
   "metadata": {},
   "outputs": [],
   "source": [
    "import ROOT"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "excited-mechanism",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "TFile**\t\thistos.root\t\n",
      " TFile*\t\thistos.root\t\n",
      "  KEY: TH1D\tData_bdt;1\tData_bdt\n",
      "  KEY: TH1D\tQCD_bdt;1\tQCD_bdt\n",
      "  KEY: TH1D\tTTJets_signal_centJER_bdt;1\tTTJets_signal_centJER_bdt\n",
      "  KEY: TH1D\tTTJets_bkg_centJER_bdt;1\tTTJets_bkg_centJER_bdt\n",
      "  KEY: TH1D\tSTJets_centJER_bdt;1\tSTJets_centJER_bdt\n",
      "  KEY: TH1D\tWZJets_centJER_bdt;1\tWZJets_centJER_bdt\n"
     ]
    }
   ],
   "source": [
    "f = ROOT.TFile(\"histos.root\")\n",
    "f.ls()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "annual-blogger",
   "metadata": {},
   "outputs": [],
   "source": [
    "import fit"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "falling-salad",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_centJER_bdt\n",
      "TTJets_bkg 143.36512967476312\n",
      "WZJets_centJER_bdt\n",
      "WZJets 63.73465056276217\n",
      "STJets_centJER_bdt\n",
      "STJets 30.22478553713198\n",
      "QCD_bdt\n",
      "QCD 2776.1690616287597\n",
      "TTJets_signal_centJER_bdt\n",
      "TTJets_signal 347.1658808435184\n",
      "scale factor TTbar tau(h) QQ  0.8894053761504759 +- 0.07905309039471264\n",
      "scale factor MultiJet  1.0074689874060399 +- 0.00988575809002827\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **   19 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **   20 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **   21 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **   22 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **   23 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **   24 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=-476.489 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.29029e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1047.93 FROM MIGRAD    STATUS=CONVERGED      20 CALLS          21 TOTAL\n",
      "                     EDM=1.13251e-07    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           9.94216e-02   8.83690e-03   6.60275e-04   1.13936e-02\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.811e-05 \n",
      " **********\n",
      " **   25 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **   26 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **   27 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1047.93 FROM HESSE     STATUS=OK              5 CALLS          26 TOTAL\n",
      "                     EDM=1.13192e-07    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           9.94216e-02   8.83690e-03   1.32055e-04  -9.29226e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.811e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n"
     ]
    }
   ],
   "source": [
    "sample_names = [\"Data\", \"TTJets_bkg\", \"WZJets\", \"STJets\", \"QCD\", \"TTJets_signal\"]\n",
    "sf_tt_sig, sf_qcd = fit.fit(\"histos.root\", sample_names, \"bdt\", corr=\"centJER\")\n",
    "sfs = {}\n",
    "sfs[\"TTJets_signal\"] = sf_tt_sig\n",
    "sfs[\"QCD\"] = sf_qcd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "military-cosmetic",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "empty-constitutional",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
