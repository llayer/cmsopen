{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "basic-street",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import glob\n",
    "import importlib"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "digital-entity",
   "metadata": {},
   "outputs": [],
   "source": [
    "import xgboost as xgb"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "subsequent-processor",
   "metadata": {},
   "outputs": [],
   "source": [
    "import shap"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "internal-singles",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "general-sending",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "naughty-medicare",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "compatible-petroleum",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "empty-parts",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "veterinary-number",
   "metadata": {},
   "source": [
    "## BDT training"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "mathematical-drawing",
   "metadata": {},
   "outputs": [],
   "source": [
    "CAND_DIR = \"cand_loose\"\n",
    "corrections = [\"centJER\", \"jes_up\", \"jes_down\", \"jes_up_old\", \"jes_down_old\", \"jer_up\", \"jer_down\", \"tau_eup\", \"tau_edown\"]\n",
    "\n",
    "def get_samples():\n",
    "\n",
    "    files = glob.glob( CAND_DIR + \"/*.h5\")\n",
    "    samples = {}\n",
    "    for sample in files:\n",
    "        sample_name = sample.split(\"/\")[-1][:-3]\n",
    "        print(sample_name)\n",
    "        if (sample_name != \"Data\") & (sample_name != \"QCD\"):\n",
    "            for key in [\"central\", \"met_up\", \"met_down\"] + corrections:\n",
    "                samples[sample_name + \"_\" + key] = pd.read_hdf(sample, sample_name + \"_\" + key)\n",
    "        else:\n",
    "            samples[sample_name] = pd.read_hdf(sample)\n",
    "            \n",
    "    return samples"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "unique-mixer",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Data\n",
      "QCD\n",
      "STJets\n",
      "TTJets_bkg\n",
      "TTJets_signal\n",
      "WZJets\n"
     ]
    }
   ],
   "source": [
    "samples = get_samples()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "integral-munich",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "dict_keys(['Data', 'QCD', 'STJets_central', 'STJets_met_up', 'STJets_met_down', 'STJets_centJER', 'STJets_jes_up', 'STJets_jes_down', 'STJets_jes_up_old', 'STJets_jes_down_old', 'STJets_jer_up', 'STJets_jer_down', 'STJets_tau_eup', 'STJets_tau_edown', 'TTJets_bkg_central', 'TTJets_bkg_met_up', 'TTJets_bkg_met_down', 'TTJets_bkg_centJER', 'TTJets_bkg_jes_up', 'TTJets_bkg_jes_down', 'TTJets_bkg_jes_up_old', 'TTJets_bkg_jes_down_old', 'TTJets_bkg_jer_up', 'TTJets_bkg_jer_down', 'TTJets_bkg_tau_eup', 'TTJets_bkg_tau_edown', 'TTJets_signal_central', 'TTJets_signal_met_up', 'TTJets_signal_met_down', 'TTJets_signal_centJER', 'TTJets_signal_jes_up', 'TTJets_signal_jes_down', 'TTJets_signal_jes_up_old', 'TTJets_signal_jes_down_old', 'TTJets_signal_jer_up', 'TTJets_signal_jer_down', 'TTJets_signal_tau_eup', 'TTJets_signal_tau_edown', 'WZJets_central', 'WZJets_met_up', 'WZJets_met_down', 'WZJets_centJER', 'WZJets_jes_up', 'WZJets_jes_down', 'WZJets_jes_up_old', 'WZJets_jes_down_old', 'WZJets_jer_up', 'WZJets_jer_down', 'WZJets_tau_eup', 'WZJets_tau_edown'])"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "samples.keys()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "accepting-pitch",
   "metadata": {},
   "outputs": [],
   "source": [
    "samples[\"TTJets_signal_centJER\"][\"pdf_up\"] = samples[\"TTJets_signal_centJER\"][\"pdf_up\"].fillna(0.)\n",
    "samples[\"TTJets_signal_centJER\"][\"pdf_down\"] = samples[\"TTJets_signal_centJER\"][\"pdf_down\"].fillna(0.)\n",
    "samples[\"TTJets_bkg_centJER\"][\"pdf_up\"] = samples[\"TTJets_bkg_centJER\"][\"pdf_up\"].fillna(0.)\n",
    "samples[\"TTJets_bkg_centJER\"][\"pdf_down\"] = samples[\"TTJets_bkg_centJER\"][\"pdf_down\"].fillna(0.)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "italic-syntax",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "11235"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len(samples[\"QCD\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "fixed-nursery",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Welcome to JupyROOT 6.20/06\n"
     ]
    }
   ],
   "source": [
    "import ml"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "postal-breathing",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Prepare training data\n",
      "['Jet_pt', 'Jet_px', 'Jet_py', 'Jet_pz', 'Jet_e', 'Jet_eta', 'Jet_phi', 'Jet_mass', 'Jet_csvDisc', 'Jet_flavour', 'Tau_pt', 'Tau_px', 'Tau_py', 'Tau_pz', 'Tau_e', 'Tau_eta', 'Tau_phi', 'Tau_mass', 'Tau_charge', 'MET_pt', 'MET_px', 'MET_py', 'MET_pz', 'MET_e', 'MET_met', 'event', 'run', 'luminosityBlock', 'HLT_QuadJet40_IsoPFTau40', 'HLT_QuadJet45_IsoPFTau45', 'genEvent_tmeme', 'nJets', 'Jet_nbtags', 'ht', 'aplanarity', 'sphericity', 'chargeEta', 'met', 'deltaPhiTauMet', 'mt', 'mTauJet', 'Jet_btagSF', 'Jet_btagSF_up', 'Jet_btagSF_down', 'Jet_beff', 'Jet_btag_weight1', 'Jet_btag_weight1_up', 'Jet_btag_weight1_down', 'trigger_weight', 'trigger_weight_up', 'trigger_weight_down', 'norm', 'norm_up', 'norm_down', 'train_flag']\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/eos/home-l/llayer/cmsopen/columnar/ml.py:88: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  signal_train[\"weights\"] = signal_train['trigger_weight'] * signal_train['Jet_btag_weight1']\n",
      "/eos/home-l/llayer/cmsopen/columnar/ml.py:89: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  signal_train[\"weights\"] = signal_train[\"weights\"] * (1. / np.mean(signal_train[\"weights\"]))\n",
      "/eos/home-l/llayer/cmsopen/columnar/ml.py:92: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  bkg_train[\"weights\"] = bkg_train['btag_weight']\n",
      "/eos/home-l/llayer/cmsopen/columnar/ml.py:93: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  bkg_train[\"weights\"] = bkg_train[\"weights\"] * (1. / np.mean(bkg_train[\"weights\"]))\n",
      "/eos/home-l/llayer/cmsopen/columnar/ml.py:96: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version\n",
      "of pandas will change to not sort by default.\n",
      "\n",
      "To accept the future behavior, pass 'sort=False'.\n",
      "\n",
      "To retain the current behavior and silence the warning, pass 'sort=True'.\n",
      "\n",
      "  train_data = pd.concat([signal_train, bkg_train], axis=0)\n",
      "/eos/home-l/llayer/cmsopen/columnar/ml.py:97: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version\n",
      "of pandas will change to not sort by default.\n",
      "\n",
      "To accept the future behavior, pass 'sort=False'.\n",
      "\n",
      "To retain the current behavior and silence the warning, pass 'sort=True'.\n",
      "\n",
      "  test_data = pd.concat([signal_test, bkg_test], axis=0)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train model\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/cvmfs/sft.cern.ch/lcg/views/LCG_97apython3/x86_64-centos7-gcc8-opt/lib/python3.7/site-packages/xgboost/core.py:587: FutureWarning: Series.base is deprecated and will be removed in a future version\n",
      "  if getattr(data, 'base', None) is not None and \\\n",
      "/cvmfs/sft.cern.ch/lcg/views/LCG_97apython3/x86_64-centos7-gcc8-opt/lib/python3.7/site-packages/xgboost/core.py:588: FutureWarning: Series.base is deprecated and will be removed in a future version\n",
      "  data.base is not None and isinstance(data, np.ndarray) \\\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Importance\n",
      "ht 0.040442035\n",
      "aplanarity 0.094627365\n",
      "sphericity 0.035212163\n",
      "chargeEta 0.10917759\n",
      "met 0.51533014\n",
      "deltaPhiTauMet 0.1477881\n",
      "mt 0.02040142\n",
      "mTauJet 0.037021138\n",
      "Predicting...\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "importlib.reload(ml)\n",
    "ml.train(samples, n_sig=4000, n_bkg=4000, ntrees=1000, lr=0.01)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "celtic-tucson",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "dict_keys(['Data', 'QCD', 'STJets_central', 'STJets_met_up', 'STJets_met_down', 'STJets_centJER', 'STJets_jes_up', 'STJets_jes_down', 'STJets_jes_up_old', 'STJets_jes_down_old', 'STJets_jer_up', 'STJets_jer_down', 'STJets_tau_eup', 'STJets_tau_edown', 'TTJets_bkg_central', 'TTJets_bkg_met_up', 'TTJets_bkg_met_down', 'TTJets_bkg_centJER', 'TTJets_bkg_jes_up', 'TTJets_bkg_jes_down', 'TTJets_bkg_jes_up_old', 'TTJets_bkg_jes_down_old', 'TTJets_bkg_jer_up', 'TTJets_bkg_jer_down', 'TTJets_bkg_tau_eup', 'TTJets_bkg_tau_edown', 'TTJets_signal_central', 'TTJets_signal_met_up', 'TTJets_signal_met_down', 'TTJets_signal_centJER', 'TTJets_signal_jes_up', 'TTJets_signal_jes_down', 'TTJets_signal_jes_up_old', 'TTJets_signal_jes_down_old', 'TTJets_signal_jer_up', 'TTJets_signal_jer_down', 'TTJets_signal_tau_eup', 'TTJets_signal_tau_edown', 'WZJets_central', 'WZJets_met_up', 'WZJets_met_down', 'WZJets_centJER', 'WZJets_jes_up', 'WZJets_jes_down', 'WZJets_jes_up_old', 'WZJets_jes_down_old', 'WZJets_jer_up', 'WZJets_jer_down', 'WZJets_tau_eup', 'WZJets_tau_edown'])"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "samples.keys()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "curious-bulgaria",
   "metadata": {},
   "source": [
    "## Histograms"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "deluxe-factory",
   "metadata": {},
   "outputs": [],
   "source": [
    "import plot\n",
    "import importlib"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "protected-battle",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<module 'plot' from '/eos/home-l/llayer/cmsopen/columnar/plot.py'>"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "importlib.reload(plot)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "robust-franchise",
   "metadata": {},
   "outputs": [],
   "source": [
    "variables = [\n",
    "    {\"var_name\" : \"bdt\", \"bins\" : 30, \"xlow\" : 0., \"xup\" : 1., \"xtitle\" : \"bdt\"}\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "tender-fluid",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Data bdt None\n",
      "QCD bdt None\n",
      "STJets_central bdt None\n",
      "STJets_met_up bdt None\n",
      "STJets_met_down bdt None\n",
      "STJets_centJER bdt None\n",
      "STJets_centJER bdt btag_up\n",
      "STJets_centJER bdt btag_down\n",
      "STJets_centJER bdt trigger_up\n",
      "STJets_centJER bdt trigger_down\n",
      "STJets_centJER bdt xsec_up\n",
      "STJets_centJER bdt xsec_down\n",
      "STJets_jes_up bdt None\n",
      "STJets_jes_down bdt None\n",
      "STJets_jes_up_old bdt None\n",
      "STJets_jes_down_old bdt None\n",
      "STJets_jer_up bdt None\n",
      "STJets_jer_down bdt None\n",
      "STJets_tau_eup bdt None\n",
      "STJets_tau_edown bdt None\n",
      "TTJets_bkg_central bdt None\n",
      "TTJets_bkg_met_up bdt None\n",
      "TTJets_bkg_met_down bdt None\n",
      "TTJets_bkg_centJER bdt None\n",
      "TTJets_bkg_centJER bdt btag_up\n",
      "TTJets_bkg_centJER bdt btag_down\n",
      "TTJets_bkg_centJER bdt trigger_up\n",
      "TTJets_bkg_centJER bdt trigger_down\n",
      "TTJets_bkg_centJER bdt xsec_up\n",
      "TTJets_bkg_centJER bdt xsec_down\n",
      "TTJets_bkg_centJER bdt pdf_up\n",
      "TTJets_bkg_centJER bdt pdf_down\n",
      "TTJets_bkg_jes_up bdt None\n",
      "TTJets_bkg_jes_down bdt None\n",
      "TTJets_bkg_jes_up_old bdt None\n",
      "TTJets_bkg_jes_down_old bdt None\n",
      "TTJets_bkg_jer_up bdt None\n",
      "TTJets_bkg_jer_down bdt None\n",
      "TTJets_bkg_tau_eup bdt None\n",
      "TTJets_bkg_tau_edown bdt None\n",
      "TTJets_signal_central bdt None\n",
      "TTJets_signal_met_up bdt None\n",
      "TTJets_signal_met_down bdt None\n",
      "TTJets_signal_centJER bdt None\n",
      "TTJets_signal_centJER bdt btag_up\n",
      "TTJets_signal_centJER bdt btag_down\n",
      "TTJets_signal_centJER bdt trigger_up\n",
      "TTJets_signal_centJER bdt trigger_down\n",
      "TTJets_signal_centJER bdt xsec_up\n",
      "TTJets_signal_centJER bdt xsec_down\n",
      "TTJets_signal_centJER bdt pdf_up\n",
      "TTJets_signal_centJER bdt pdf_down\n",
      "TTJets_signal_jes_up bdt None\n",
      "TTJets_signal_jes_down bdt None\n",
      "TTJets_signal_jes_up_old bdt None\n",
      "TTJets_signal_jes_down_old bdt None\n",
      "TTJets_signal_jer_up bdt None\n",
      "TTJets_signal_jer_down bdt None\n",
      "TTJets_signal_tau_eup bdt None\n",
      "TTJets_signal_tau_edown bdt None\n",
      "WZJets_central bdt None\n",
      "WZJets_met_up bdt None\n",
      "WZJets_met_down bdt None\n",
      "WZJets_centJER bdt None\n",
      "WZJets_centJER bdt btag_up\n",
      "WZJets_centJER bdt btag_down\n",
      "WZJets_centJER bdt trigger_up\n",
      "WZJets_centJER bdt trigger_down\n",
      "WZJets_centJER bdt xsec_up\n",
      "WZJets_centJER bdt xsec_down\n",
      "WZJets_jes_up bdt None\n",
      "WZJets_jes_down bdt None\n",
      "WZJets_jes_up_old bdt None\n",
      "WZJets_jes_down_old bdt None\n",
      "WZJets_jer_up bdt None\n",
      "WZJets_jer_down bdt None\n",
      "WZJets_tau_eup bdt None\n",
      "WZJets_tau_edown bdt None\n"
     ]
    }
   ],
   "source": [
    "plot.vars_to_histos(samples, variables, file_name = \"bdt_nb\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "cross-arthur",
   "metadata": {},
   "outputs": [],
   "source": [
    "import ROOT"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "confused-basketball",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "TFile**\t\thistos/bdt_nb.root\t\n",
      " TFile*\t\thistos/bdt_nb.root\t\n",
      "  OBJ: TH1D\tTTJets_signal_centJER_bdt\tTTJets_signal_centJER_bdt : 0 at: 0xceca7fa0\n",
      "  KEY: TH1D\tData_bdt;1\tData_bdt\n",
      "  KEY: TH1D\tQCD_bdt;1\tQCD_bdt\n",
      "  KEY: TH1D\tSTJets_central_bdt;1\tSTJets_central_bdt\n",
      "  KEY: TH1D\tSTJets_met_up_bdt;1\tSTJets_met_up_bdt\n",
      "  KEY: TH1D\tSTJets_met_down_bdt;1\tSTJets_met_down_bdt\n",
      "  KEY: TH1D\tSTJets_centJER_bdt;1\tSTJets_centJER_bdt\n",
      "  KEY: TH1D\tSTJets_centJER_btag_up_bdt;1\tSTJets_centJER_bdt_btag_up\n",
      "  KEY: TH1D\tSTJets_centJER_btag_down_bdt;1\tSTJets_centJER_bdt_btag_down\n",
      "  KEY: TH1D\tSTJets_centJER_trigger_up_bdt;1\tSTJets_centJER_bdt_trigger_up\n",
      "  KEY: TH1D\tSTJets_centJER_trigger_down_bdt;1\tSTJets_centJER_bdt_trigger_down\n",
      "  KEY: TH1D\tSTJets_centJER_xsec_up_bdt;1\tSTJets_centJER_bdt_xsec_up\n",
      "  KEY: TH1D\tSTJets_centJER_xsec_down_bdt;1\tSTJets_centJER_bdt_xsec_down\n",
      "  KEY: TH1D\tSTJets_jes_up_bdt;1\tSTJets_jes_up_bdt\n",
      "  KEY: TH1D\tSTJets_jes_down_bdt;1\tSTJets_jes_down_bdt\n",
      "  KEY: TH1D\tSTJets_jes_up_old_bdt;1\tSTJets_jes_up_old_bdt\n",
      "  KEY: TH1D\tSTJets_jes_down_old_bdt;1\tSTJets_jes_down_old_bdt\n",
      "  KEY: TH1D\tSTJets_jer_up_bdt;1\tSTJets_jer_up_bdt\n",
      "  KEY: TH1D\tSTJets_jer_down_bdt;1\tSTJets_jer_down_bdt\n",
      "  KEY: TH1D\tSTJets_tau_eup_bdt;1\tSTJets_tau_eup_bdt\n",
      "  KEY: TH1D\tSTJets_tau_edown_bdt;1\tSTJets_tau_edown_bdt\n",
      "  KEY: TH1D\tTTJets_bkg_central_bdt;1\tTTJets_bkg_central_bdt\n",
      "  KEY: TH1D\tTTJets_bkg_met_up_bdt;1\tTTJets_bkg_met_up_bdt\n",
      "  KEY: TH1D\tTTJets_bkg_met_down_bdt;1\tTTJets_bkg_met_down_bdt\n",
      "  KEY: TH1D\tTTJets_bkg_centJER_bdt;1\tTTJets_bkg_centJER_bdt\n",
      "  KEY: TH1D\tTTJets_bkg_centJER_btag_up_bdt;1\tTTJets_bkg_centJER_bdt_btag_up\n",
      "  KEY: TH1D\tTTJets_bkg_centJER_btag_down_bdt;1\tTTJets_bkg_centJER_bdt_btag_down\n",
      "  KEY: TH1D\tTTJets_bkg_centJER_trigger_up_bdt;1\tTTJets_bkg_centJER_bdt_trigger_up\n",
      "  KEY: TH1D\tTTJets_bkg_centJER_trigger_down_bdt;1\tTTJets_bkg_centJER_bdt_trigger_down\n",
      "  KEY: TH1D\tTTJets_bkg_centJER_xsec_up_bdt;1\tTTJets_bkg_centJER_bdt_xsec_up\n",
      "  KEY: TH1D\tTTJets_bkg_centJER_xsec_down_bdt;1\tTTJets_bkg_centJER_bdt_xsec_down\n",
      "  KEY: TH1D\tTTJets_bkg_centJER_pdf_up_bdt;1\tTTJets_bkg_centJER_bdt_pdf_up\n",
      "  KEY: TH1D\tTTJets_bkg_centJER_pdf_down_bdt;1\tTTJets_bkg_centJER_bdt_pdf_down\n",
      "  KEY: TH1D\tTTJets_bkg_jes_up_bdt;1\tTTJets_bkg_jes_up_bdt\n",
      "  KEY: TH1D\tTTJets_bkg_jes_down_bdt;1\tTTJets_bkg_jes_down_bdt\n",
      "  KEY: TH1D\tTTJets_bkg_jes_up_old_bdt;1\tTTJets_bkg_jes_up_old_bdt\n",
      "  KEY: TH1D\tTTJets_bkg_jes_down_old_bdt;1\tTTJets_bkg_jes_down_old_bdt\n",
      "  KEY: TH1D\tTTJets_bkg_jer_up_bdt;1\tTTJets_bkg_jer_up_bdt\n",
      "  KEY: TH1D\tTTJets_bkg_jer_down_bdt;1\tTTJets_bkg_jer_down_bdt\n",
      "  KEY: TH1D\tTTJets_bkg_tau_eup_bdt;1\tTTJets_bkg_tau_eup_bdt\n",
      "  KEY: TH1D\tTTJets_bkg_tau_edown_bdt;1\tTTJets_bkg_tau_edown_bdt\n",
      "  KEY: TH1D\tTTJets_signal_central_bdt;1\tTTJets_signal_central_bdt\n",
      "  KEY: TH1D\tTTJets_signal_met_up_bdt;1\tTTJets_signal_met_up_bdt\n",
      "  KEY: TH1D\tTTJets_signal_met_down_bdt;1\tTTJets_signal_met_down_bdt\n",
      "  KEY: TH1D\tTTJets_signal_centJER_bdt;1\tTTJets_signal_centJER_bdt\n",
      "  KEY: TH1D\tTTJets_signal_centJER_btag_up_bdt;1\tTTJets_signal_centJER_bdt_btag_up\n",
      "  KEY: TH1D\tTTJets_signal_centJER_btag_down_bdt;1\tTTJets_signal_centJER_bdt_btag_down\n",
      "  KEY: TH1D\tTTJets_signal_centJER_trigger_up_bdt;1\tTTJets_signal_centJER_bdt_trigger_up\n",
      "  KEY: TH1D\tTTJets_signal_centJER_trigger_down_bdt;1\tTTJets_signal_centJER_bdt_trigger_down\n",
      "  KEY: TH1D\tTTJets_signal_centJER_xsec_up_bdt;1\tTTJets_signal_centJER_bdt_xsec_up\n",
      "  KEY: TH1D\tTTJets_signal_centJER_xsec_down_bdt;1\tTTJets_signal_centJER_bdt_xsec_down\n",
      "  KEY: TH1D\tTTJets_signal_centJER_pdf_up_bdt;1\tTTJets_signal_centJER_bdt_pdf_up\n",
      "  KEY: TH1D\tTTJets_signal_centJER_pdf_down_bdt;1\tTTJets_signal_centJER_bdt_pdf_down\n",
      "  KEY: TH1D\tTTJets_signal_jes_up_bdt;1\tTTJets_signal_jes_up_bdt\n",
      "  KEY: TH1D\tTTJets_signal_jes_down_bdt;1\tTTJets_signal_jes_down_bdt\n",
      "  KEY: TH1D\tTTJets_signal_jes_up_old_bdt;1\tTTJets_signal_jes_up_old_bdt\n",
      "  KEY: TH1D\tTTJets_signal_jes_down_old_bdt;1\tTTJets_signal_jes_down_old_bdt\n",
      "  KEY: TH1D\tTTJets_signal_jer_up_bdt;1\tTTJets_signal_jer_up_bdt\n",
      "  KEY: TH1D\tTTJets_signal_jer_down_bdt;1\tTTJets_signal_jer_down_bdt\n",
      "  KEY: TH1D\tTTJets_signal_tau_eup_bdt;1\tTTJets_signal_tau_eup_bdt\n",
      "  KEY: TH1D\tTTJets_signal_tau_edown_bdt;1\tTTJets_signal_tau_edown_bdt\n",
      "  KEY: TH1D\tWZJets_central_bdt;1\tWZJets_central_bdt\n",
      "  KEY: TH1D\tWZJets_met_up_bdt;1\tWZJets_met_up_bdt\n",
      "  KEY: TH1D\tWZJets_met_down_bdt;1\tWZJets_met_down_bdt\n",
      "  KEY: TH1D\tWZJets_centJER_bdt;1\tWZJets_centJER_bdt\n",
      "  KEY: TH1D\tWZJets_centJER_btag_up_bdt;1\tWZJets_centJER_bdt_btag_up\n",
      "  KEY: TH1D\tWZJets_centJER_btag_down_bdt;1\tWZJets_centJER_bdt_btag_down\n",
      "  KEY: TH1D\tWZJets_centJER_trigger_up_bdt;1\tWZJets_centJER_bdt_trigger_up\n",
      "  KEY: TH1D\tWZJets_centJER_trigger_down_bdt;1\tWZJets_centJER_bdt_trigger_down\n",
      "  KEY: TH1D\tWZJets_centJER_xsec_up_bdt;1\tWZJets_centJER_bdt_xsec_up\n",
      "  KEY: TH1D\tWZJets_centJER_xsec_down_bdt;1\tWZJets_centJER_bdt_xsec_down\n",
      "  KEY: TH1D\tWZJets_jes_up_bdt;1\tWZJets_jes_up_bdt\n",
      "  KEY: TH1D\tWZJets_jes_down_bdt;1\tWZJets_jes_down_bdt\n",
      "  KEY: TH1D\tWZJets_jes_up_old_bdt;1\tWZJets_jes_up_old_bdt\n",
      "  KEY: TH1D\tWZJets_jes_down_old_bdt;1\tWZJets_jes_down_old_bdt\n",
      "  KEY: TH1D\tWZJets_jer_up_bdt;1\tWZJets_jer_up_bdt\n",
      "  KEY: TH1D\tWZJets_jer_down_bdt;1\tWZJets_jer_down_bdt\n",
      "  KEY: TH1D\tWZJets_tau_eup_bdt;1\tWZJets_tau_eup_bdt\n",
      "  KEY: TH1D\tWZJets_tau_edown_bdt;1\tWZJets_tau_edown_bdt\n"
     ]
    }
   ],
   "source": [
    "f.ls()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "eligible-interval",
   "metadata": {},
   "outputs": [],
   "source": [
    "f = ROOT.TFile(\"histos/bdt_nb.root\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "posted-maldives",
   "metadata": {},
   "outputs": [],
   "source": [
    "h = f.Get(\"TTJets_signal_centJER_pdf_up_bdt\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "veterinary-gauge",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ROOT.TH1D"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "type(h)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "pending-deposit",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<IPython.core.display.Image object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "c = ROOT.TCanvas()\n",
    "h.Draw()\n",
    "c.Draw()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "reported-douglas",
   "metadata": {},
   "source": [
    "## Stack"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "raised-olive",
   "metadata": {},
   "outputs": [],
   "source": [
    "import stack"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "functioning-eclipse",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Scaling QCD by 0.73\n",
      "Scaling TTJets_signal by 1.0\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Info in <TCanvas::Print>: png file stacks_corr/bdt_central_postfit.png has been created\n"
     ]
    }
   ],
   "source": [
    "#importlib.reload(stack)\n",
    "sample_names = [\"TTJets_bkg\", \"WZJets\", \"STJets\", \"QCD\", \"TTJets_signal\"]\n",
    "sfs = {}\n",
    "sfs[\"TTJets_signal\"] = 1.\n",
    "sfs[\"QCD\"] = 0.73\n",
    "for var in variables:\n",
    "    stack.plot( \"histos/\" + \"bdt_nb\" + \".root\", var[\"var_name\"], var[\"xtitle\"], sample_names, sfs=sfs, corr = \"central\" )"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "harmful-layer",
   "metadata": {},
   "source": [
    "## Syst"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "median-estimate",
   "metadata": {},
   "outputs": [],
   "source": [
    "import ROOT"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "pretty-serbia",
   "metadata": {},
   "outputs": [],
   "source": [
    "f = ROOT.TFile(\"histos/bdt_nb.root\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "surface-diary",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<ROOT.TH1D object (\"TTJets_signal_centJER_btag_down_bdt\") at 0x813fb10>"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "f.Get(\"TTJets_signal_centJER_btag_down_bdt\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "twelve-algorithm",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'ROOT.TH1D'>\n",
      "TTJets_signal_centJER_bdt\n",
      "<class 'ROOT.TH1D'>\n",
      "TTJets_signal_centJER_btag_up_bdt\n",
      "TTJets_signal_centJER_btag_down_bdt\n",
      "<class 'ROOT.TH1D'>\n",
      "bdt bdt\n",
      "<class 'ROOT.TH1D'>\n",
      "TTJets_signal_centJER_trigger_up_bdt\n",
      "TTJets_signal_centJER_trigger_down_bdt\n",
      "<class 'ROOT.TH1D'>\n",
      "bdt bdt\n",
      "<class 'ROOT.TH1D'>\n",
      "TTJets_signal_centJER_xsec_up_bdt\n",
      "TTJets_signal_centJER_xsec_down_bdt\n",
      "<class 'ROOT.TH1D'>\n",
      "bdt bdt\n",
      "<class 'ROOT.TH1D'>\n",
      "TTJets_signal_centJER_pdf_up_bdt\n",
      "TTJets_signal_centJER_pdf_down_bdt\n",
      "<class 'ROOT.TH1D'>\n",
      "bdt bdt\n",
      "bdt bdt\n",
      "bdt bdt\n",
      "bdt bdt\n",
      "bdt bdt\n",
      "bdt bdt\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TCanvas::Constructor>: Deleting canvas with same name: c\n",
      "Info in <TCanvas::Print>: png file syst/bdt_btag.png has been created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TCanvas::Constructor>: Deleting canvas with same name: c\n",
      "Info in <TCanvas::Print>: png file syst/bdt_trigger.png has been created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TCanvas::Constructor>: Deleting canvas with same name: c\n",
      "Info in <TCanvas::Print>: png file syst/bdt_xsec.png has been created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TCanvas::Constructor>: Deleting canvas with same name: c\n",
      "Info in <TCanvas::Print>: png file syst/bdt_pdf.png has been created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TCanvas::Constructor>: Deleting canvas with same name: c\n",
      "Info in <TCanvas::Print>: png file syst/bdt_JES.png has been created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TCanvas::Constructor>: Deleting canvas with same name: c\n",
      "Info in <TCanvas::Print>: png file syst/bdt_JER.png has been created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TCanvas::Constructor>: Deleting canvas with same name: c\n",
      "Info in <TCanvas::Print>: png file syst/bdt_Tau Scale.png has been created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TCanvas::Constructor>: Deleting canvas with same name: c\n",
      "Info in <TCanvas::Print>: png file syst/bdt_JES old.png has been created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TCanvas::Constructor>: Deleting canvas with same name: c\n",
      "Info in <TCanvas::Print>: png file syst/bdt_JES old.png has been created\n"
     ]
    }
   ],
   "source": [
    "importlib.reload(plot)\n",
    "plot.syst(variables, sample = \"TTJets_signal\", file_name = \"bdt_nb\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "hundred-custom",
   "metadata": {},
   "outputs": [],
   "source": [
    "TTJets_signal_centJER_btag_up_bdt\n",
    "TTJets_signal_centJER_btag_up_bdt"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cross-democracy",
   "metadata": {},
   "source": [
    "## Fit"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "timely-olympus",
   "metadata": {},
   "outputs": [],
   "source": [
    "import fit"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "median-portuguese",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_centJER_bdt\n",
      "TTJets_bkg 143.2548703377998\n",
      "WZJets_centJER_bdt\n",
      "WZJets 63.342947935142455\n",
      "STJets_centJER_bdt\n",
      "STJets 30.165996274894944\n",
      "QCD_bdt\n",
      "QCD 3803.0034445550423\n",
      "TTJets_signal_centJER_bdt\n",
      "TTJets_signal 347.1281179556397\n",
      "scale factor TTbar tau(h) QQ  0.9214735847990575 +- 0.07791342052562594\n",
      "scale factor MultiJet  0.7326753274979056 +- 0.007111731405152924\n",
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_jes_up_bdt\n",
      "TTJets_bkg 145.76828344086593\n",
      "WZJets_jes_up_bdt\n",
      "WZJets 65.15419346825847\n",
      "STJets_jes_up_bdt\n",
      "STJets 30.935160310569525\n",
      "QCD_bdt\n",
      "QCD 3803.0034445550423\n",
      "TTJets_signal_jes_up_bdt\n",
      "TTJets_signal 354.6369360690969\n",
      "scale factor TTbar tau(h) QQ  0.9073829655543513 +- 0.07655581246915763\n",
      "scale factor MultiJet  0.7308304839992089 +- 0.007138967704910655\n",
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_jes_down_bdt\n",
      "TTJets_bkg 140.42892027660224\n",
      "WZJets_jes_down_bdt\n",
      "WZJets 62.434014152392876\n",
      "STJets_jes_down_bdt\n",
      "STJets 29.514357300815963\n",
      "QCD_bdt\n",
      "QCD 3803.0034445550423\n",
      "TTJets_signal_jes_down_bdt\n",
      "TTJets_signal 338.2703270110728\n",
      "scale factor TTbar tau(h) QQ  0.9379497171282354 +- 0.07949900052962246\n",
      "scale factor MultiJet  0.7345094979434348 +- 0.007071293333881077\n",
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_jes_up_old_bdt\n",
      "TTJets_bkg 147.463326280664\n",
      "WZJets_jes_up_old_bdt\n",
      "WZJets 66.4911658280238\n",
      "STJets_jes_up_old_bdt\n",
      "STJets 31.56016812844896\n",
      "QCD_bdt\n",
      "QCD 3803.0034445550423\n",
      "TTJets_signal_jes_up_old_bdt\n",
      "TTJets_signal 358.2458555049086\n",
      "scale factor TTbar tau(h) QQ  0.9055324626482582 +- 0.07623309314167208\n",
      "scale factor MultiJet  0.729182113143846 +- 0.007181216127854186\n",
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_jes_down_old_bdt\n",
      "TTJets_bkg 139.13871781848383\n",
      "WZJets_jes_down_old_bdt\n",
      "WZJets 61.9438785964927\n",
      "STJets_jes_down_old_bdt\n",
      "STJets 29.090571140883306\n",
      "QCD_bdt\n",
      "QCD 3803.0034445550423\n",
      "TTJets_signal_jes_down_old_bdt\n",
      "TTJets_signal 333.60369320318875\n",
      "scale factor TTbar tau(h) QQ  0.9433344245523222 +- 0.08026744110830779\n",
      "scale factor MultiJet  0.7357676702854434 +- 0.007041149235886098\n",
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_jer_up_bdt\n",
      "TTJets_bkg 139.79736919251792\n",
      "WZJets_jer_up_bdt\n",
      "WZJets 64.19386104683738\n",
      "STJets_jer_up_bdt\n",
      "STJets 29.560848249013887\n",
      "QCD_bdt\n",
      "QCD 3803.0034445550423\n",
      "TTJets_signal_jer_up_bdt\n",
      "TTJets_signal 344.6999722109652\n",
      "scale factor TTbar tau(h) QQ  0.926566087047167 +- 0.07823832158273655\n",
      "scale factor MultiJet  0.7336466184508784 +- 0.007091433828179779\n",
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_jer_down_bdt\n",
      "TTJets_bkg 146.26629469151203\n",
      "WZJets_jer_down_bdt\n",
      "WZJets 63.68873397380727\n",
      "STJets_jer_down_bdt\n",
      "STJets 30.96679368035005\n",
      "QCD_bdt\n",
      "QCD 3803.0034445550423\n",
      "TTJets_signal_jer_down_bdt\n",
      "TTJets_signal 349.18047045653304\n",
      "scale factor TTbar tau(h) QQ  0.9169003961745567 +- 0.07754441286829675\n",
      "scale factor MultiJet  0.7315045874963195 +- 0.0071198974603599256\n",
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_tau_eup_bdt\n",
      "TTJets_bkg 148.7911971380711\n",
      "WZJets_tau_eup_bdt\n",
      "WZJets 62.30991450734996\n",
      "STJets_tau_eup_bdt\n",
      "STJets 30.820839777387814\n",
      "QCD_bdt\n",
      "QCD 3803.0034445550423\n",
      "TTJets_signal_tau_eup_bdt\n",
      "TTJets_signal 353.51199224690765\n",
      "scale factor TTbar tau(h) QQ  0.9010504163419091 +- 0.07620236492693017\n",
      "scale factor MultiJet  0.7316706285830932 +- 0.007083467115396422\n",
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_tau_edown_bdt\n",
      "TTJets_bkg 134.84316469577465\n",
      "WZJets_tau_edown_bdt\n",
      "WZJets 63.532626409522535\n",
      "STJets_tau_edown_bdt\n",
      "STJets 28.76702944141954\n",
      "QCD_bdt\n",
      "QCD 3803.0034445550423\n",
      "TTJets_signal_tau_edown_bdt\n",
      "TTJets_signal 329.916166797164\n",
      "scale factor TTbar tau(h) QQ  0.9812991582128759 +- 0.08251996522400026\n",
      "scale factor MultiJet  0.7341856938604716 +- 0.007158728885695968\n",
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_met_up_bdt\n",
      "TTJets_bkg 155.1371488545426\n",
      "WZJets_met_up_bdt\n",
      "WZJets 67.37052951377493\n",
      "STJets_met_up_bdt\n",
      "STJets 31.928266763321943\n",
      "QCD_bdt\n",
      "QCD 3803.0034445550423\n",
      "TTJets_signal_met_up_bdt\n",
      "TTJets_signal 354.9576694572058\n",
      "scale factor TTbar tau(h) QQ  0.9163804015139916 +- 0.07729238084006922\n",
      "scale factor MultiJet  0.7266067053310296 +- 0.007214172632178554\n",
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_met_down_bdt\n",
      "TTJets_bkg 136.57343188463943\n",
      "WZJets_met_down_bdt\n",
      "WZJets 63.362859207928025\n",
      "STJets_met_down_bdt\n",
      "STJets 29.589529968337903\n",
      "QCD_bdt\n",
      "QCD 3803.0034445550423\n",
      "TTJets_signal_met_down_bdt\n",
      "TTJets_signal 342.5272666317852\n",
      "scale factor TTbar tau(h) QQ  0.9121222228996663 +- 0.07755431881890482\n",
      "scale factor MultiJet  0.7365356061156265 +- 0.006985128787764634\n",
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_centJER_btag_up_bdt\n",
      "TTJets_bkg 145.14559104962692\n",
      "WZJets_centJER_btag_up_bdt\n",
      "WZJets 67.59199689998911\n",
      "STJets_centJER_btag_up_bdt\n",
      "STJets 30.735127309265387\n",
      "QCD_bdt\n",
      "QCD 3803.0034445550423\n",
      "TTJets_signal_centJER_btag_up_bdt\n",
      "TTJets_signal 351.3939923816229\n",
      "scale factor TTbar tau(h) QQ  0.8970466011707324 +- 0.07660478801690129\n",
      "scale factor MultiJet  0.7321346243295709 +- 0.007078211389828587\n",
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_centJER_btag_down_bdt\n",
      "TTJets_bkg 141.27928862767718\n",
      "WZJets_centJER_btag_down_bdt\n",
      "WZJets 59.052741686785055\n",
      "STJets_centJER_btag_down_bdt\n",
      "STJets 29.58316668032922\n",
      "QCD_bdt\n",
      "QCD 3803.0034445550423\n",
      "TTJets_signal_centJER_btag_down_bdt\n",
      "TTJets_signal 342.6696857037947\n",
      "scale factor TTbar tau(h) QQ  0.9472435772021791 +- 0.07930292277411427\n",
      "scale factor MultiJet  0.733234451342091 +- 0.007145591114650575\n",
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_centJER_trigger_up_bdt\n",
      "TTJets_bkg 147.0912275475032\n",
      "WZJets_centJER_trigger_up_bdt\n",
      "WZJets 65.13903922005662\n",
      "STJets_centJER_trigger_up_bdt\n",
      "STJets 30.997794333321472\n",
      "QCD_bdt\n",
      "QCD 3803.0034445550423\n",
      "TTJets_signal_centJER_trigger_up_bdt\n",
      "TTJets_signal 356.45835855142025\n",
      "scale factor TTbar tau(h) QQ  0.8861901800043589 +- 0.07552852843476421\n",
      "scale factor MultiJet  0.7320219617355871 +- 0.007079345486317415\n",
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_centJER_trigger_down_bdt\n",
      "TTJets_bkg 139.50822772121663\n",
      "WZJets_centJER_trigger_down_bdt\n",
      "WZJets 61.585366107841715\n",
      "STJets_centJER_trigger_down_bdt\n",
      "STJets 29.3531353743561\n",
      "QCD_bdt\n",
      "QCD 3803.0034445550423\n",
      "TTJets_signal_centJER_trigger_down_bdt\n",
      "TTJets_signal 338.0150678323616\n",
      "scale factor TTbar tau(h) QQ  0.9578592908616802 +- 0.08036940835473012\n",
      "scale factor MultiJet  0.7333105105689458 +- 0.007143320118619915\n",
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_centJER_xsec_up_bdt\n",
      "TTJets_bkg 151.98992340717786\n",
      "WZJets_centJER_xsec_up_bdt\n",
      "WZJets 66.36944844280481\n",
      "STJets_centJER_xsec_up_bdt\n",
      "STJets 32.146268011902755\n",
      "QCD_bdt\n",
      "QCD 3803.0034445550423\n",
      "TTJets_signal_centJER_xsec_up_bdt\n",
      "TTJets_signal 368.2944666114712\n",
      "scale factor TTbar tau(h) QQ  0.8472600249634797 +- 0.07278843676670706\n",
      "scale factor MultiJet  0.7311203425660547 +- 0.007049054486884301\n",
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_centJER_xsec_down_bdt\n",
      "TTJets_bkg 134.51981726842175\n",
      "WZJets_centJER_xsec_down_bdt\n",
      "WZJets 60.316447427480085\n",
      "STJets_centJER_xsec_down_bdt\n",
      "STJets 28.11408902995513\n",
      "QCD_bdt\n",
      "QCD 3803.0034445550423\n",
      "TTJets_signal_centJER_xsec_down_bdt\n",
      "TTJets_signal 325.96176929980754\n",
      "scale factor TTbar tau(h) QQ  1.0055200182853785 +- 0.08369963179094235\n",
      "scale factor MultiJet  0.7342324567297807 +- 0.007174035066252781\n",
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_centJER_pdf_up_bdt\n",
      "TTJets_bkg 156.77522541506033\n",
      "WZJets_centJER_bdt\n",
      "WZJets 63.342947935142455\n",
      "STJets_centJER_bdt\n",
      "STJets 30.165996274894944\n",
      "QCD_bdt\n",
      "QCD 3803.0034445550423\n",
      "TTJets_signal_centJER_pdf_up_bdt\n",
      "TTJets_signal 385.7961397702231\n",
      "scale factor TTbar tau(h) QQ  0.812587397747121 +- 0.06956405654527578\n",
      "scale factor MultiJet  0.7307968003755796 +- 0.0070569340452083015\n",
      "Data_bdt\n",
      "Data 3343.0\n",
      "TTJets_bkg_centJER_pdf_down_bdt\n",
      "TTJets_bkg 130.8952617732021\n",
      "WZJets_centJER_bdt\n",
      "WZJets 63.342947935142455\n",
      "STJets_centJER_bdt\n",
      "STJets 30.165996274894944\n",
      "QCD_bdt\n",
      "QCD 3803.0034445550423\n",
      "TTJets_signal_centJER_pdf_down_bdt\n",
      "TTJets_signal 311.7741075594946\n",
      "scale factor TTbar tau(h) QQ  1.045127011948263 +- 0.08738189785125423\n",
      "scale factor MultiJet  0.7343543841851622 +- 0.007163657255802784\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **  343 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  344 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **  345 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  346 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  347 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **  348 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=-497.228 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.30052e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1068.79 FROM MIGRAD    STATUS=CONVERGED      17 CALLS          18 TOTAL\n",
      "                     EDM=7.51481e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           1.02977e-01   8.70698e-03   6.38690e-04   3.02554e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.583e-05 \n",
      " **********\n",
      " **  349 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  350 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  351 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1068.79 FROM HESSE     STATUS=OK              5 CALLS          23 TOTAL\n",
      "                     EDM=7.51471e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           1.02977e-01   8.70698e-03   1.27738e-04  -9.17438e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.583e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **  352 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  353 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **  354 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  355 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  356 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **  357 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=-505.515 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.29022e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1071.16 FROM MIGRAD    STATUS=CONVERGED      17 CALLS          18 TOTAL\n",
      "                     EDM=7.09968e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           1.03765e-01   8.75468e-03   6.40834e-04   2.93465e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.667e-05 \n",
      " **********\n",
      " **  358 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  359 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  360 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1071.16 FROM HESSE     STATUS=OK              5 CALLS          23 TOTAL\n",
      "                     EDM=7.09958e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           1.03765e-01   8.75468e-03   1.28167e-04  -9.14847e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.667e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **  361 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  362 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **  363 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  364 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  365 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **  366 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=-488.253 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.30979e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1066.19 FROM MIGRAD    STATUS=CONVERGED      17 CALLS          18 TOTAL\n",
      "                     EDM=7.06339e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           1.01999e-01   8.64526e-03   6.36257e-04   2.94175e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.476e-05 \n",
      " **********\n",
      " **  367 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  368 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  369 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1066.19 FROM HESSE     STATUS=OK              5 CALLS          23 TOTAL\n",
      "                     EDM=7.0633e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           1.01999e-01   8.64526e-03   1.27251e-04  -9.20661e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.476e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **  370 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  371 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **  372 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  373 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  374 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **  375 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=-512.894 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.27986e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1071.82 FROM MIGRAD    STATUS=CONVERGED      17 CALLS          18 TOTAL\n",
      "                     EDM=7.37292e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           1.04731e-01   8.81689e-03   6.42845e-04   2.98167e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.776e-05 \n",
      " **********\n",
      " **  376 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  377 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  378 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1071.82 FROM HESSE     STATUS=OK              5 CALLS          23 TOTAL\n",
      "                     EDM=7.37282e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           1.04731e-01   8.81689e-03   1.28569e-04  -9.11686e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.776e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **  379 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  380 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **  381 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  382 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  383 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **  384 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=-481.449 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.31603e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1064.2 FROM MIGRAD    STATUS=CONVERGED      17 CALLS          18 TOTAL\n",
      "                     EDM=6.96656e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           1.01098e-01   8.60231e-03   6.35019e-04   2.92457e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.402e-05 \n",
      " **********\n",
      " **  385 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  386 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  387 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1064.2 FROM HESSE     STATUS=OK              5 CALLS          23 TOTAL\n",
      "                     EDM=6.96647e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           1.01098e-01   8.60231e-03   1.27004e-04  -9.23645e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.402e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **  388 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  389 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **  390 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  391 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  392 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **  393 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=-492.567 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.30644e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1067.41 FROM MIGRAD    STATUS=CONVERGED      17 CALLS          18 TOTAL\n",
      "                     EDM=7.13636e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           1.02715e-01   8.67316e-03   6.36692e-04   2.95654e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.524e-05 \n",
      " **********\n",
      " **  394 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  395 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  396 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1067.41 FROM HESSE     STATUS=OK              5 CALLS          23 TOTAL\n",
      "                     EDM=7.13627e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           1.02715e-01   8.67316e-03   1.27338e-04  -9.18299e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.524e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **  397 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  398 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **  399 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  400 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  401 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **  402 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=-502.115 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.29414e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1070.68 FROM MIGRAD    STATUS=CONVERGED      17 CALLS          18 TOTAL\n",
      "                     EDM=7.05962e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           1.03209e-01   8.72866e-03   6.40320e-04   2.92812e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.621e-05 \n",
      " **********\n",
      " **  403 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  404 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  405 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1070.68 FROM HESSE     STATUS=OK              5 CALLS          23 TOTAL\n",
      "                     EDM=7.05952e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           1.03209e-01   8.72866e-03   1.28064e-04  -9.16672e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.621e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **  406 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  407 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **  408 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  409 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  410 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **  411 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=-497.196 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.30276e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1070.6 FROM MIGRAD    STATUS=CONVERGED      17 CALLS          18 TOTAL\n",
      "                     EDM=7.10942e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           1.02717e-01   8.68680e-03   6.38573e-04   2.94634e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.548e-05 \n",
      " **********\n",
      " **  412 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  413 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  414 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1070.6 FROM HESSE     STATUS=OK              5 CALLS          23 TOTAL\n",
      "                     EDM=7.10932e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           1.02717e-01   8.68680e-03   1.27715e-04  -9.18294e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.548e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **  415 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  416 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **  417 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  418 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  419 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **  420 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=-497.056 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.29871e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1065.66 FROM MIGRAD    STATUS=CONVERGED      17 CALLS          18 TOTAL\n",
      "                     EDM=7.75396e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           1.03903e-01   8.73746e-03   6.37417e-04   3.07474e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.636e-05 \n",
      " **********\n",
      " **  421 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  422 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  423 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1065.66 FROM HESSE     STATUS=OK              5 CALLS          23 TOTAL\n",
      "                     EDM=7.75385e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           1.03903e-01   8.73746e-03   1.27483e-04  -9.14396e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.636e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **  424 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  425 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **  426 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  427 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  428 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **  429 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=-518.137 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.25939e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1067.76 FROM MIGRAD    STATUS=CONVERGED      17 CALLS          18 TOTAL\n",
      "                     EDM=5.96708e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           1.05316e-01   8.88294e-03   6.45290e-04   2.66899e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.893e-05 \n",
      " **********\n",
      " **  430 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  431 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  432 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1067.76 FROM HESSE     STATUS=OK              5 CALLS          23 TOTAL\n",
      "                     EDM=5.96699e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           1.05316e-01   8.88294e-03   1.29058e-04  -9.09778e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.893e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **  433 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  434 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **  435 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  436 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  437 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **  438 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=-478.896 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.34139e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1072.93 FROM MIGRAD    STATUS=CONVERGED      20 CALLS          21 TOTAL\n",
      "                     EDM=1.93426e-08    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           1.00347e-01   8.53210e-03   6.42477e-04   4.89702e-03\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.282e-05 \n",
      " **********\n",
      " **  439 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  440 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  441 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1072.93 FROM HESSE     STATUS=OK              5 CALLS          26 TOTAL\n",
      "                     EDM=1.93257e-08    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           1.00347e-01   8.53210e-03   1.28495e-04  -9.26141e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.282e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **  442 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  443 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **  444 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  445 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  446 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **  447 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=-497.101 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.30226e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1071.75 FROM MIGRAD    STATUS=CONVERGED      17 CALLS          18 TOTAL\n",
      "                     EDM=8.40141e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           1.01698e-01   8.68470e-03   6.41161e-04   3.18955e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.544e-05 \n",
      " **********\n",
      " **  448 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  449 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  450 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1071.75 FROM HESSE     STATUS=OK              5 CALLS          23 TOTAL\n",
      "                     EDM=8.4013e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           1.01698e-01   8.68470e-03   1.28232e-04  -9.21655e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.544e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **  451 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  452 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **  453 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  454 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  455 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **  456 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=-497.33 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.29877e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1065.8 FROM MIGRAD    STATUS=CONVERGED      17 CALLS          18 TOTAL\n",
      "                     EDM=6.72055e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           1.04267e-01   8.72919e-03   6.36210e-04   2.86967e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.622e-05 \n",
      " **********\n",
      " **  457 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  458 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  459 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1065.8 FROM HESSE     STATUS=OK              5 CALLS          23 TOTAL\n",
      "                     EDM=6.72046e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           1.04267e-01   8.72919e-03   1.27242e-04  -9.13204e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.622e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **  460 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  461 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **  462 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  463 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  464 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **  465 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=-497.126 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.30228e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1071.45 FROM MIGRAD    STATUS=CONVERGED      17 CALLS          18 TOTAL\n",
      "                     EDM=8.12877e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           1.01907e-01   8.68541e-03   6.40635e-04   3.13998e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.546e-05 \n",
      " **********\n",
      " **  466 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  467 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  468 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1071.45 FROM HESSE     STATUS=OK              5 CALLS          23 TOTAL\n",
      "                     EDM=8.12867e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           1.01907e-01   8.68541e-03   1.28127e-04  -9.20964e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.546e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **  469 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  470 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **  471 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  472 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  473 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **  474 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=-497.339 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.29878e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1066.21 FROM MIGRAD    STATUS=CONVERGED      17 CALLS          18 TOTAL\n",
      "                     EDM=6.96254e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           1.04021e-01   8.72791e-03   6.36808e-04   2.91826e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.620e-05 \n",
      " **********\n",
      " **  475 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  476 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  477 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1066.21 FROM HESSE     STATUS=OK              5 CALLS          23 TOTAL\n",
      "                     EDM=6.96245e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           1.04021e-01   8.72791e-03   1.27362e-04  -9.14009e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.620e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **  478 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  479 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **  480 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  481 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  482 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **  483 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=-497.692 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.30310e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1074.25 FROM MIGRAD    STATUS=CONVERGED      17 CALLS          18 TOTAL\n",
      "                     EDM=8.79993e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           1.00903e-01   8.66859e-03   6.42814e-04   3.25901e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.517e-05 \n",
      " **********\n",
      " **  484 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  485 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  486 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1074.25 FROM HESSE     STATUS=OK              5 CALLS          23 TOTAL\n",
      "                     EDM=8.79982e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           1.00903e-01   8.66859e-03   1.28563e-04  -9.24292e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.517e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **  487 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  488 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **  489 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  490 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  491 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **  492 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=-496.771 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.29794e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1063.39 FROM MIGRAD    STATUS=CONVERGED      17 CALLS          18 TOTAL\n",
      "                     EDM=6.42311e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           1.05050e-01   8.74437e-03   6.34617e-04   2.80984e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.648e-05 \n",
      " **********\n",
      " **  493 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  494 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  495 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1063.39 FROM HESSE     STATUS=OK              5 CALLS          23 TOTAL\n",
      "                     EDM=6.42302e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           1.05050e-01   8.74437e-03   1.26923e-04  -9.10646e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.648e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **  496 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  497 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **  498 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  499 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  500 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **  501 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=-498.48 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.29913e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1072.9 FROM MIGRAD    STATUS=CONVERGED      17 CALLS          18 TOTAL\n",
      "                     EDM=7.65934e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           1.01365e-01   8.67766e-03   6.42113e-04   3.04347e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.532e-05 \n",
      " **********\n",
      " **  502 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  503 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  504 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1072.9 FROM HESSE     STATUS=OK              5 CALLS          23 TOTAL\n",
      "                     EDM=7.65924e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           1.01365e-01   8.67766e-03   1.28423e-04  -9.22759e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.532e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n",
      "[#1] INFO:DataHandling -- RooDataHist::adjustBinning(signal): fit range of variable x expanded to nearest bin boundaries: [0,350] --> [0,1]\n",
      "[#0] WARNING:InputArguments -- RooAbsPdf::fitTo(pdf) WARNING: a likelihood fit is requested of what appears to be weighted data.\n",
      "       While the estimated values of the parameters will always be calculated taking the weights into account,\n",
      "       there are multiple ways to estimate the errors of the parameters. You are advised to make an \n",
      "       explicit choice for the error calculation:\n",
      "           - Either provide SumW2Error(true), to calculate a sum-of-weights-corrected HESSE error matrix\n",
      "             (error will be proportional to the number of events in MC).\n",
      "           - Or provide SumW2Error(false), to return errors from original HESSE error matrix\n",
      "             (which will be proportional to the sum of the weights, i.e., a dataset with <sum of weights> events).\n",
      "           - Or provide AsymptoticError(true), to use the asymptotically correct expression\n",
      "             (for details see https://arxiv.org/abs/1911.01303).\n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: activating const optimization\n",
      "[#1] INFO:Minization --  The following expressions have been identified as constant and will be precalculated and cached: (signal,bkg)\n",
      " **********\n",
      " **  505 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  506 **SET NOGRAD\n",
      " **********\n",
      " PARAMETER DEFINITIONS:\n",
      "    NO.   NAME         VALUE      STEP SIZE      LIMITS\n",
      "     1 c0           5.00000e-01  1.00000e-01    0.00000e+00  1.00000e+00\n",
      " **********\n",
      " **  507 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  508 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  509 **SET STR           1\n",
      " **********\n",
      " NOW USING STRATEGY  1: TRY TO BALANCE SPEED AGAINST RELIABILITY\n",
      " **********\n",
      " **  510 **MIGRAD         500           1\n",
      " **********\n",
      " FIRST CALL TO USER FUNCTION AT NEW START POINT, WITH IFLAG=4.\n",
      " START MIGRAD MINIMIZATION.  STRATEGY  1.  CONVERGENCE WHEN EDM .LT. 1.00e-03\n",
      " FCN=-496.258 FROM MIGRAD    STATUS=INITIATE        4 CALLS           5 TOTAL\n",
      "                     EDM= unknown      STRATEGY= 1      NO ERROR MATRIX       \n",
      "  EXT PARAMETER               CURRENT GUESS       STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           5.00000e-01   1.00000e-01   2.01358e-01   1.30149e+03\n",
      "                               ERR DEF= 0.5\n",
      " MIGRAD MINIMIZATION HAS CONVERGED.\n",
      " MIGRAD WILL VERIFY CONVERGENCE AND ERROR MATRIX.\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1065 FROM MIGRAD    STATUS=CONVERGED      17 CALLS          18 TOTAL\n",
      "                     EDM=7.4433e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                   STEP         FIRST   \n",
      "  NO.   NAME      VALUE            ERROR          SIZE      DERIVATIVE \n",
      "   1  c0           1.04484e-01   8.73580e-03   6.35654e-04   3.02053e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.633e-05 \n",
      " **********\n",
      " **  511 **SET ERR         0.5\n",
      " **********\n",
      " **********\n",
      " **  512 **SET PRINT           1\n",
      " **********\n",
      " **********\n",
      " **  513 **HESSE         500\n",
      " **********\n",
      " COVARIANCE MATRIX CALCULATED SUCCESSFULLY\n",
      " FCN=-1065 FROM HESSE     STATUS=OK              5 CALLS          23 TOTAL\n",
      "                     EDM=7.4432e-05    STRATEGY= 1      ERROR MATRIX ACCURATE \n",
      "  EXT PARAMETER                                INTERNAL      INTERNAL  \n",
      "  NO.   NAME      VALUE            ERROR       STEP SIZE       VALUE   \n",
      "   1  c0           1.04484e-01   8.73579e-03   1.27131e-04  -9.12494e-01\n",
      "                               ERR DEF= 0.5\n",
      " EXTERNAL ERROR MATRIX.    NDIM=  25    NPAR=  1    ERR DEF=0.5\n",
      "  7.633e-05 \n",
      "[#1] INFO:Minization -- RooMinimizer::optimizeConst: deactivating const optimization\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n",
      "Warning in <TH1D::Sumw2>: Sum of squares of weights structure already created\n"
     ]
    }
   ],
   "source": [
    "#importlib.reload(fit)\n",
    "\n",
    "syst=True\n",
    "\n",
    "sample_names = [\"Data\", \"TTJets_bkg\", \"WZJets\", \"STJets\", \"QCD\", \"TTJets_signal\"]\n",
    "sf_tt_sig, sf_qcd = fit.fit(\"histos/\" + \"bdt_nb\" + \".root\", sample_names, \"bdt\", corr=\"centJER\")\n",
    "sfs = {}\n",
    "sfs[\"TTJets_signal\"] = sf_tt_sig\n",
    "sfs[\"QCD\"] = sf_qcd\n",
    "#stack.plot( \"histos/\" + file_name + \".root\", var, sample_names[1:], sfs )\n",
    "\n",
    "if syst:\n",
    "\n",
    "    # PU - not applied\n",
    "    # JES/JER/TauScale/MET\n",
    "    for c in  [\"jes_up\", \"jes_down\", \"jes_up_old\", \"jes_down_old\", \"jer_up\", \"jer_down\", \"tau_eup\", \"tau_edown\",\n",
    "               \"met_up\", \"met_down\"]:\n",
    "        sf_tt_sig, sf_qcd = fit.fit(\"histos/\" + \"bdt_nb\" + \".root\", sample_names, \"bdt\", corr=c)     \n",
    "        sfs[\"TTJets_signal_\" + c] = sf_tt_sig\n",
    "        \n",
    "    # B-tagging, Trigger stat, XSEC theory, PDF\n",
    "    for c in [\"btag_up\", \"btag_down\", \"trigger_up\", \"trigger_down\", \"xsec_up\", \"xsec_down\", \"pdf_up\", \"pdf_down\"]:\n",
    "        sf_tt_sig, sf_qcd = fit.fit(\"histos/\" + \"bdt_nb\" + \".root\", sample_names, \"bdt\", corr = \"centJER_\" + c)     \n",
    "        sfs[\"TTJets_signal_\" + c] = sf_tt_sig"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "funny-jungle",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'TTJets_signal': 0.9214735847990575,\n",
       " 'QCD': 0.7326753274979056,\n",
       " 'TTJets_signal_jes_up': 0.9073829655543513,\n",
       " 'TTJets_signal_jes_down': 0.9379497171282354,\n",
       " 'TTJets_signal_jes_up_old': 0.9055324626482582,\n",
       " 'TTJets_signal_jes_down_old': 0.9433344245523222,\n",
       " 'TTJets_signal_jer_up': 0.926566087047167,\n",
       " 'TTJets_signal_jer_down': 0.9169003961745567,\n",
       " 'TTJets_signal_tau_eup': 0.9010504163419091,\n",
       " 'TTJets_signal_tau_edown': 0.9812991582128759,\n",
       " 'TTJets_signal_met_up': 0.9163804015139916,\n",
       " 'TTJets_signal_met_down': 0.9121222228996663,\n",
       " 'TTJets_signal_btag_up': 0.8970466011707324,\n",
       " 'TTJets_signal_btag_down': 0.9472435772021791,\n",
       " 'TTJets_signal_trigger_up': 0.8861901800043589,\n",
       " 'TTJets_signal_trigger_down': 0.9578592908616802,\n",
       " 'TTJets_signal_xsec_up': 0.8472600249634797,\n",
       " 'TTJets_signal_xsec_down': 1.0055200182853785,\n",
       " 'TTJets_signal_pdf_up': 0.812587397747121,\n",
       " 'TTJets_signal_pdf_down': 1.045127011948263}"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sfs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "located-maryland",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "TTJets_signal 0.0\n",
      "TTJets_signal_jes_up 0.015291397905647961\n",
      "TTJets_signal_jes_down -0.01788020036707919\n",
      "TTJets_signal_jes_up_old 0.017299597529185355\n",
      "TTJets_signal_jes_down_old -0.023723783420261373\n",
      "TTJets_signal_jer_up -0.005526476647966024\n",
      "TTJets_signal_jer_down 0.0049629079986032425\n",
      "TTJets_signal_tau_eup 0.022163596215947993\n",
      "TTJets_signal_tau_edown -0.06492380725907015\n",
      "TTJets_signal_met_up 0.005527215721736146\n",
      "TTJets_signal_met_down 0.010148269091653289\n",
      "TTJets_signal_btag_up 0.026508609721733672\n",
      "TTJets_signal_btag_down -0.027966067425298124\n",
      "TTJets_signal_trigger_up 0.03829019667708948\n",
      "TTJets_signal_trigger_down -0.0394864341885147\n",
      "TTJets_signal_xsec_up 0.0805379134679821\n",
      "TTJets_signal_xsec_down -0.09120872792533573\n",
      "TTJets_signal_pdf_up 0.11816528313796533\n",
      "TTJets_signal_pdf_down -0.13419096237703887\n"
     ]
    }
   ],
   "source": [
    "for sample, sf in sfs.items():\n",
    "    if \"TTJets\" in sample:\n",
    "        print( sample, (sfs[\"TTJets_signal\"] - sf) / sfs[\"TTJets_signal\"] )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "sorted-insulin",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "failing-middle",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "federal-implementation",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "external-assault",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "native-legislation",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "behavioral-operator",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "plain-denial",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "criminal-compound",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
